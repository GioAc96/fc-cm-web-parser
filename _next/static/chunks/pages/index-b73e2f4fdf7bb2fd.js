(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[332],{7276:(e,t,r)=>{(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return r(5025)}])},5025:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>L});var i=r(4848),n=r(6540);class a{static bigSizeBytes(e){return e<253n?1:e<65536n?3:e<4294967296n?5:9}get position(){return this._position}set position(e){this._position=e}get eof(){return this._position>=this._buffer.length}get buffer(){return this._buffer}get lastReadBytes(){return this._lastReadBytes}readUInt8(){return this._readNumber(1,"getUint8")}readUInt16LE(){return this._readNumber(2,"getUint16",!0)}readUInt16BE(){return this._readNumber(2,"getUint16",!1)}readUInt32LE(){return this._readNumber(4,"getUint32",!0)}readUInt32BE(){return this._readNumber(4,"getUint32",!1)}readUInt64BE(){return this._readBigInt(8,!1)}readUInt64LE(){return this._readBigInt(8,!0)}readUIntLE(e){return this._readNumber(e,"getUint"+8*e,!0)}readUIntBE(e){return this._readNumber(e,"getUint"+8*e,!1)}readVarUint(){let e=this.readUInt8();return e<253?BigInt(e):253===e?BigInt(this.readUInt16LE()):254===e?BigInt(this.readUInt32LE()):this.readUInt64LE()}readBigSize(){let e=this.readUInt8();return e<253?BigInt(e):253===e?BigInt(this.readUInt16BE()):254===e?BigInt(this.readUInt32BE()):this.readUInt64BE()}readBytes(e){let t=this._buffer.slice(this._position,this._position+e);return this._position+=e,this._lastReadBytes=e,t}peakBytes(e){return this._buffer.slice(this._position,this._position+e)}readTUInt16(){return this._readTUInt(2)}readTUInt32(){return this._readTUInt(4)}readTUInt64(){return this._readTUInt(8,!0)}_readNumber(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=this._view[t](this._position,r);return this._position+=e,this._lastReadBytes=e,i}_readBigInt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Array.from(this.readBytes(e)).map(e=>e.toString(16).padStart(2,"0")).join("");return t&&(r=r.match(/../g).reverse().join("")),BigInt("0x"+r)}_readTUInt(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=Math.min(e,this._buffer.length-this._position);return 0===r?t?0n:0:t?this._readBigInt(r,!1):this._readNumber(r,"getUint"+8*r,!1)}constructor(e){this._buffer=e,this._view=new DataView(e.buffer.slice(e.byteOffset,e.byteOffset+e.byteLength)),this._position=0,this._lastReadBytes=0}}var s=r(8805),o=r.n(s),l=r(7995),d=r.n(l);let p="DB\0\b\0\0\0\0",h={unpackDbs:async e=>{let t,r,i=e.indexOf(p),n=new a(e);if(i<0)return!1;n.position=0;let s=[];for(;i>=0;)n.position=i+p.length,t=n.readUInt32LE(),n.position=i,r=i+t,s.push(n.readBytes(t)),i=e.indexOf(p,r);return s},readDb:async(e,t)=>{let r,i,n,s,l,h=await o().parseStringPromise(t),u=d().parseXmlDb(h),c=e.indexOf(p),g=new a(e);if(g.readBytes(c),g.readBytes(p.length),g.readUInt32LE()!=g.buffer.length)throw Error("Invalid database size");g.readBytes(4);let f=g.readUInt32LE();g.readBytes(4);let m=[],_=[];for(let e=0;e<f;e++)m.push(g.readBytes(4).toString()),_.push(g.readUInt32LE());g.readBytes(4);let y=g.position,b=[],I={};for(let e=0;e<f;e++){if(void 0===(r=u.tableNames[m[e]])||(g.position=y,g.readBytes(_[e]),g.readBytes(4),i=g.readUInt32LE(),g.readBytes(10),n=g.readUInt16LE(),g.readBytes(4),s=g.readUInt8(),g.readBytes(11),n<=0))continue;let t=[],a=[],o=[],p=[],h=[];for(let e=0;e<s;e++)l=g.readUInt32LE(),t.push(l),a.push(g.readUInt32LE()),o.push(g.readBytes(4).toString()),p.push(g.readUInt32LE()),0==l&&h.push(e);let c=Object.keys(a).sort((e,t)=>a[e]-a[t]),f=[],v=[],B=[],k=[],U=[];for(let e=0;e<s;e++){let r=c[e];v.push(t[r]),B.push(a[r]),k.push(o[r]),U.push(p[r]);let i=u.fieldNames[k[e]];void 0!==i&&f.push(i),b.push(k)}let w=[];for(let t=0;t<n;t++){let t={},r=0,n=0,a=g.position;for(let i=0;i<s;i++){let s=v[i],o="";switch(s){case 0:r=0,n=0,g.position=a+(B[i]>>3),o=d().readNullbyteStr(g,U[i]>>3);break;case 3:let l=0,p=0,h=U[i];for(0!=n&&(p=8-n,l=r>>n);p<h;)l+=(r=g.readUInt8())<<p,p+=8;n=h+8-p&7,l&=(1<<h)-1;let c=u.tableNames[m[e]]+u.fieldNames[k[i]];o=l+u.fieldRange[c];break;case 4:g.position=a+(B[i]>>3),o=g.readUInt32LE()}t[f[Object.keys(t).length]]=o}g.position=a+i,w.push(t)}I[r]=w}return I},parseSave:async(e,t)=>Promise.all((await h.unpackDbs(e)).map(e=>h.readDb(e,t)))},u=r(8287).Buffer,c=(e,t)=>(void 0===t&&(t=Array.from(Object.keys(e[0]))),[t.join(","),...e.map(e=>t.map(t=>{var r;return null!==(r=e[t])&&void 0!==r?r:""}).join(","))].join("\n")),g=e=>new Date(new Date("15 October 1582").getTime()+864e5*e).toISOString().split("T")[0],f=e=>({"-1":"",0:"GK",3:"RB",4:"RCB",5:"CB",6:"LCB",7:"LB",9:"RDM",10:"CDM",11:"LDM",12:"RM",13:"RCM",14:"CM",15:"LCM",16:"LM",17:"RAM",18:"CAM",19:"LAM",20:"RF",22:"LF",23:"RW",24:"RS",25:"ST",26:"LS",27:"LW"})[e],m=(e,t)=>e.split("").reduce((e,r,i)=>("1"===r&&e.push(t[i]),e),[]),_=(e,t)=>(new Uint32Array([e])[0]>>>0).toString(2).padStart(t,"0"),y=["Finesse Shot","Chip Shot","Power Shot","Dead Ball","Power Header","Incisive Pass","Pinged Pass","Long Ball Pass","Tiki Taka","Whipped Cross","Jockey","Block","Intercept","Anticipate","Slide Tackle","Bruiser","Technical","Rapid","Flair","First Touch","Trickster","Press Proven","Quick Step","Relentless","Trivela","Acrobatic","Long Throw","Aerial","Far Throw","Footwork"].reverse(),b=["Cross Claimer","1v1 Close Down","Far Reach","Quick Reflexes","Long Shot Taker (CPU AI)","Early Crosser (CPU AI)","Solid Player","Team Player","One Club Player","Injury Prone","Leadership"].reverse(),I=e=>{let t=_(e.trait1,y.length),r=_(e.trait2,b.length);return[...m(t,y),...m(r,b)].join("|")},v=e=>{let t=_(e.icontrait1,y.length),r=_(e.icontrait2,b.length);return[...m(t,y),...m(r,b)].join("|")},B=e=>[f(e.preferredposition1),f(e.preferredposition2),f(e.preferredposition3),f(e.preferredposition4)].filter(e=>e.length>0).sort().join("|"),k=e=>111592==e.teamid?"":e.contractvaliduntil,U=e=>({gk_diving:e.gkdiving,gk_reflexes:e.gkreflexes,gk_kicking:e.gkkicking,gk_handling:e.gkhandling,gk_positioning:e.gkpositioning,crossing:e.crossing,finishing:e.finishing,heading_accuracy:e.headingaccuracy,volleys:e.volleys,short_passing:e.shortpassing,dribbling:e.dribbling,curve:e.curve,freekick_accuracy:e.freekickaccuracy,long_passing:e.longpassing,ball_control:e.ballcontrol,acceleration:e.acceleration,sprint_speed:e.sprintspeed,agility:e.agility,reactions:e.reactions,balance:e.balance,shot_power:e.shotpower,jumping:e.jumping,stamina:e.stamina,strength:e.strength,long_shots:e.longshots,aggression:e.aggression,interceptions:e.interceptions,positioning:e.positioning,vision:e.vision,penalties:e.penalties,composure:e.composure,defensive_awareness:e.defensiveawareness,sliding_tackle:e.slidingtackle,standing_tackle:e.standingtackle}),w=async(e,t)=>{let r=Object.fromEntries(t.replaceAll("\r","").split("\n").slice(1).map(e=>e.split(",")).map(e=>{let[t,r,i]=e;return[t,i]})),i=Object.fromEntries(e[1].leagueteamlinks.map(e=>[e.teamid,e])),n=Object.fromEntries(e[1].teams.map(e=>[e.teamid,e])),a=Object.fromEntries(e[1].players.filter(e=>0==e.gender).map(e=>{var t,i,n;return[e.playerid,{player_id:e.playerid,first_name:null!==(t=r[e.firstnameid])&&void 0!==t?t:"",last_name:null!==(i=r[e.lastnameid])&&void 0!==i?i:"",common_name:null!==(n=r[e.commonnameid])&&void 0!==n?n:"",current_team:"",owner_team:"",overall:e.overallrating,potential:e.potential,birthdate:g(e.birthdate),preferred_position:B(e),playstyles:I(e),playstyles_plus:v(e),contract_expiry:k(e),wage:"",skill_moves:e.skillmoves,weak_foot:e.weakfootabilitytypecode,height:e.height,...U(e),international_reputation:e.internationalrep}]}));return e[1].teamplayerlinks.forEach(e=>{var t;let r=a[e.playerid],s=n[e.teamid],o=null===(t=i[e.teamid])||void 0===t?void 0:t.leagueid;void 0!==r&&void 0!==s&&78!=o&&(r.current_team=s.teamname,r.owner_team=s.teamname)}),e[0].career_playercontract.forEach(e=>{let t=a[e.playerid];void 0!==t&&(t.wage=e.wage)}),e[1].playerloans.forEach(e=>{let t=a[e.playerid],r=n[e.teamidloanedfrom];void 0!==t&&void 0!==r&&(t.owner_team=r.teamname)}),Object.values(a)},E=async(e,t,r)=>{let i=new FileReader;i.readAsArrayBuffer(e),i.onload=async()=>{let e=new u(i.result),n=await h.parseSave(e,t);!function(e,t){let r=new Blob([t],{type:"text/plain"}),i=URL.createObjectURL(r),n=document.createElement("a");n.href=i,n.download=e,document.body.appendChild(n),n.click(),document.body.removeChild(n),URL.revokeObjectURL(i)}("players.csv",c(await w(n,r)))}};function L(){let[e,t]=(0,n.useState)(null),[r,a]=(0,n.useState)(null);return(0,n.useEffect)(async()=>{let e=await fetch("/fifa_ng_db-meta.xml");t(await e.text())},[]),(0,n.useEffect)(async()=>{let e=await fetch("/playernames.csv");a(await e.text())},[]),(0,i.jsx)("div",{children:(0,i.jsx)("input",{type:"file",onChange:t=>{E(t.target.files[0],e,r)}})})}},7995:e=>{"use strict";e.exports={parseXmlDb:e=>{let t={},r={},i={},n={};for(let a=0;a<Object.keys(e.database.table).length;a++){let s=e.database.table[a];t[s.$.shortname]=s.$.name;for(let e=0;e<s.fields[0].field.length;e++){let t=s.fields[0].field[e];r[t.$.shortname]=t.$.name,"DBOFIELDTYPE_INTEGER"==t.$.type?i[s.$.name+t.$.name]=parseInt(t.$.rangelow):i[s.$.name+t.$.name]=0,"key"in t.$&&"True"===t.$.key&&(n[s.$.name]=t.$.name)}}return{tableNames:t,fieldNames:r,fieldRange:i,pkeys:n}},readNullbyteStr:(e,t)=>{let r,i=e.position,n=e.readBytes(e.buffer.indexOf("\0",i)-i).toString();e.position=i+t;let a=['"',",","a","\b","\f","\r","	"];for(let e=0;e<a.length;e++)r=n.replace(a[e],"");return r.replace("\n","\\n")}}}},e=>{var t=t=>e(e.s=t);e.O(0,[805,636,593,792],()=>t(7276)),_N_E=e.O()}]);